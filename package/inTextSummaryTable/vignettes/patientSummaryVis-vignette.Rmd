---
title: "Vignette of the `inTextSummaryTable` package"
author: "Laure Cougnaud"
date: "`r format(Sys.Date(), '%B %d, %Y')`"
output: 
  rmarkdown::html_document:
    toc: true
    toc_float:
      collapsed: true
    number_sections: true
vignette: >
  %\VignetteIndexEntry{inTextSummaryTable package}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

# Introduction

```{r options, echo = FALSE}
	
	library(knitr)
	opts_chunk$set(
		echo = TRUE, results = 'asis', warning = FALSE, 
		error = FALSE, message = FALSE, cache = FALSE,
		fig.width = 8, fig.height = 7,
		fig.path = "./figures_vignette/",
		#out.width = '0.7\\textwidth', 
		fig.align = 'center')#, out.height = 0.5\\textwidth', fig.path = 'graphs/') 
	options(width = 170)#, stringsAsFactors = FALSE
	options(warn = 1)#instead of warn = 0 by default -> to have place where warnings occur in the call to Sweave function
	
```

This package `patientProfilesVis` enables to create report containing subject
profiles.

```{r loadPackages}

	library(inTextSummaryTable)
	library(pander)

```

## Data format

The input dataset for the workflow should be a data.frame, 
usually loaded from a _SAS_ data file (`sas7bdat` format).
The label of the variables stored in the `SAS` datasets is also used
for title/captions. 

The function `loadDataADaMSDTM` from the `patientProfilesVis` package can be
used to load your custom `SAS` dataset(s) of interest.
In this example, the example dataset stored in the `patientProfilesVis`
package is used.

```{r loadData}	
	
#	data(ADaMDataPelican)
#	data(labelVarsADaMPelican)

	# load data
	library(glpgUtilityFct)
	dataFiles <- list.files(
		path = "data/Pelican/ADAM",
		pattern = "*.sas7bdat",
		full.names = TRUE
	)
	dataAll <- loadDataADaMSDTM(files = dataFiles)
	labelVars <- attributes(dataAll)$labelVars

```

# Patient summarized profile

```{r createMeanSEStats}

	# create the summary table
	# only CTrough in different visits
	summaryTable <- getSummaryStatisticsTable(
		data = dataAll$ADPP,
		rowVar = "PARAMCD",
		colVar = c("PARCAT1", "AVISIT")
	)

	# create the plot
#	gg <- subjectProfileSummaryPlot(
#		data = summaryTable,
#		xVar = "AVISIT",
#		colorVar = "TRTP",
#		labelVars = labelVarsADaMPelican,
#		facetVar = "PARAMCD"
#	)
	
	# format and export the table in Word format
	ft <- exportSummaryStatisticsTable(
		data = summaryTable, 
		rowVar = "PARAMCD",
		colVar = c("PARCAT1", "AVISIT"),
		labelVars = labelVars,
		file = "summaryStatisticsTable.docx"
	)
	ft

```

## 

```{r}


```


# Appendix

## Session information


```{r includeSessionInfo, echo = FALSE}

	pander(sessionInfo())

```
